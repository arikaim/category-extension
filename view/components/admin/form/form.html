{% set model = createModel('Category','category') %}

{% if uuid is not empty %}
    {% set category = model.findById(uuid) %}
    {% set parent_id = category.parent_id|default(null) %}
    {% set branch = category.branch|default(branch) %}
{% endif %}
{% set parent_id = parent_id|default(null) %}

{% if parent_id is not empty %}
    {% set parent_category = model.findById(parent_id) %}
{% endif %}
<form class="form" id="category_form">  
    <input type="hidden" name="uuid" id="uuid" value="{{ uuid }}">
    <input type="hidden" name="parent_id" id="parent_id" value="{{ parent_id }}">
    
    <div class="{{ theme.form.field }} required">
        <label class="{{ theme.form.label }}">
            {{ parent.label }}
        </label>
        <div class="px-4">
            {{ parent_category.title|default(labels.root) }}
        </div>
    </div>
    <div class="{{ theme.form.field }} required">
        <label class="{{ theme.form.label }}">
            {{ title.label }}
        </label>
        <input 
            class="{{ theme.form.input }}"
            rule="empty"
            type="text" 
            name="title" 
            id="title" 
            {{ title.placeholder|attr('placeholder') }} 
            value="{{ category.title }}">  
    </div>   
    {{  component('system:form.fields.slug',{ 
            slug_source: 'title',
            url_path: '',
            label: 'Slug',
            show_url: false  
        }) 
    }}  
    <div class="{{ theme.form.fields }}">
        <div class="{{ theme.form.field }}">
            <label class="{{ theme.form.label }}">
                {{ labels.branch.label }}
            </label>
            <div class="join">
                <input 
                    class="{{ theme.form.input }} join-item"
                    type="text" 
                    name="branch" 
                    id="branch" 
                    {{ labels.branch.placeholder|attr('placeholder') }} 
                    value="{{ branch }}"> 
                {{  component('category::admin.branch',{ 
                        id: 'branch_select',
                        class: 'join-item'                        
                    }) 
                }} 
            </div>
        </div>
        <div class="{{ theme.form.field }}">
            <label class="{{ theme.form.label }}">
                {{ icon.label }}
            </label>
            <input 
                class="{{ theme.form.input }}"
                type="text" 
                name="icon" 
                id="icon" 
                {{ icon.placeholder|attr('placeholder') }} 
                value="{{ category.icon }}"> 
        </div>
    </div>                
    {{ component('system:form.footer') }}   
</form>